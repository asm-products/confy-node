# confy-node

Official Confy API library client for node.js

__This library is generated by [alpaca](https://github.com/pksunkara/alpaca)__

## Installation

Make sure you have [npm](https://npmjs.org) installed.

```bash
$ npm install confyio
```

#### Versions

Works with [ 0.8 / 0.9 / 0.10 / 0.11 ]

## Usage

```js
var confy = require('confyio');

// Then we instantiate a client (as shown below)
```

### Build a client

__Using this api without authentication gives an error__

##### Basic authentication

```js
var client = confy.client({
    username: 'pksunkara',
    password: 'password'
}, clientOptions);
```

### Client Options

The following options are available while instantiating a client:

 * __base__: Base url for the api
 * __api_version__: Default version of the api (to be used in url)
 * __user_agent__: Default user-agent for all requests
 * __headers__: Default headers for all requests
 * __request_type__: Default format of the request body

### Response information

__All the callbacks provided to an api call will recieve the response as shown below__

```js
// You can also omit the 'methodOptions' param below
client.klass('args').method('args', methodOptions, function (err, response) {
    if (err) console.log(err);

    response.code;
    // >>> 200

    response.headers;
    // >>> {'x-server': 'apache'}
}
```

##### JSON response

When the response sent by server is __json__, it is decoded into a hash

```js
response.body;
// >>> {'user': 'pksunkara'}
```

### Method Options

The following options are available while calling a method of an api:

 * __api_version__: Version of the api (to be used in url)
 * __headers__: Headers for the request
 * __query__: Query parameters for the url
 * __body__: Body of the request
 * __request_type__: Format of the request body

### Request body information

Set __request_type__ in options to modify the body accordingly

##### RAW request

When the value is set to __raw__, don't modify the body at all.

```js
body = 'username=pksunkara';
// >>> 'username=pksunkara'
```

##### JSON request

When the value is set to __json__, JSON encode the body.

```js
body = {'user': 'pksunkara'};
// >>> '{"user": "pksunkara"}'
```

### Authenticated User api

User who is authenticated currently.

```js
var user = client.user();
```

##### Retrieve authenticated user (GET /user)

Get the authenticated user's profile.

```js
user.retrieve(options, callback);
```

##### Update authenticated user (PATCH /user)

Update the authenticated user's profile

The following arguments are required:

 * __email__: Profile email of the user

```js
user.update("john@smith.com", options, callback);
```

### Organizations api

Organizations are owned by users and only (s)he can add/remove teams and projects for that organization. A default organization will be created for every user.

```js
var orgs = client.orgs();
```

##### List Organizations (GET /orgs)

List all organizations the authenticated user is a member of.

```js
orgs.list(options, callback);
```

##### Create an organization (POST /orgs)

Create an organization with a name and the email for billing.

The following arguments are required:

 * __name__: Name of the organization
 * __email__: Billing email of the organization

```js
orgs.create("OpenSourceProject", "admin@osp.com", options, callback);
```

##### Retrieve an organization (GET /orgs/:org)

Get an organization the user has access to.

The following arguments are required:

 * __org__: Name of the organization

```js
orgs.retrieve("bigcompany", options, callback);
```

##### Update an organization (PATCH /orgs/:org)

Update an organization the user is owner of.

The following arguments are required:

 * __org__: Name of the organization
 * __email__: Billing email of the organization

```js
orgs.update("bigcompany", "admin@bigcompany.com", options, callback);
```

### Teams api

Every organization will have a default team named Owners. Owner of the organization will be a default member for every team.

The following arguments are required:

 * __org__: Name of the organization

```js
var teams = client.teams("bigcompany");
```

##### List Teams (GET /orgs/:org/teams)

List teams of the given organization authenticated user is a member of.

```js
teams.list(options, callback);
```

##### Create a team (POST /orgs/:org/teams)

Create a team for the given organization. Authenticated user should be the owner of the organization.

The following arguments are required:

 * __name__: Name of the team
 * __description__: Description of the team

```js
teams.create("Consultants", "Guys who are contractors", options, callback);
```

##### Retrieve a team (GET /orgs/:org/teams/:team)

Get a team the user is member of.

The following arguments are required:

 * __team__: Name of the team

```js
teams.retrieve("consultants", options, callback);
```

##### Update a team (PATCH /orgs/:org/teams/:team)

Update a team. Authenticated user should be the owner of the organization.

The following arguments are required:

 * __team__: Name of the team
 * __description__: Description of the team

```js
teams.update("consultants", "Guys who are contractors", options, callback);
```

##### Delete a team (DELETE /orgs/:org/teams/:team)

Delete the given team. Cannot delete the default team in the organization. Authenticated user should be the owner of the organization.

The following arguments are required:

 * __team__: Name of the team

```js
teams.destroy("consultants", options, callback);
```

### Members api

Teams contain a list of users. The Authenticated user should be the owner of the organization.

The following arguments are required:

 * __org__: Name of the organization
 * __team__: Name of the team

```js
var members = client.members("bigcompany", "consultants");
```

##### Add a member (POST /orgs/:org/teams/:team/member)

Add the user to the given team. The __user__ in the request needs to be a string.

The following arguments are required:

 * __user__: Username of the user

```js
members.add("johnsmith", options, callback);
```

##### Remove a member (DELETE /orgs/:org/teams/:team/member)

Remove users from the given team. The __user__ in the request needs to be a string. Cannot delete the default member in a team.

The following arguments are required:

 * __user__: Username of the user

```js
members.remove("johnsmith", options, callback);
```

### Projects api

An organization can contain any number of projects.

The following arguments are required:

 * __org__: Name of the organization

```js
var projects = client.projects("bigcompany");
```

##### List projects (GET /orgs/:org/projects)

List all the projects of the organization which can be seen by the authenticated user.

```js
projects.list(options, callback);
```

##### Create a project (POST /orgs/:org/projects)

Create a project for the given organization. Authenticated user should be the owner of the organization.

The following arguments are required:

 * __name__: Name of the project
 * __description__: Description of the project

```js
projects.create("KnowledgeBase", "Support FAQ & Wiki", options, callback);
```

##### Retrieve a project (GET /orgs/:org/projects/:project)

Get a project the user has access to.

The following arguments are required:

 * __project__: Name of the project

```js
projects.retrieve("knowledgebase", options, callback);
```

##### Update a project (PATCH /orgs/:org/projects/:project)

Update a project. Authenticated user should be the owner of the organization.

The following arguments are required:

 * __project__: Name of the project
 * __description__: Description of the project

```js
projects.update("knowledgebase", "Support FAQ and Wiki", options, callback);
```

##### Delete a project (DELETE /orgs/:org/projects/:project)

Delete the given project. Cannot delete the default project in the organization. Authenticated user should be the owner of the organization.

The following arguments are required:

 * __project__: Name of the project

```js
projects.destroy("knowledgebase", options, callback);
```

### Access api

List of teams who has access to the project. Default team __Owners__ will have access to every project. Authenticated user should be the owner of the organization for the below endpoints.

The following arguments are required:

 * __org__: Name of the organization
 * __project__: Name of the project

```js
var access = client.access("bigcompany", "knowledgebase");
```

##### Add a team (POST /orgs/:org/projects/:project/access)

Give the team access to the given project. The __team__ in the request needs to be a string.

The following arguments are required:

 * __team__: Name of the team

```js
access.add("consultants", options, callback);
```

##### Remove a team (DELETE /orgs/:org/projects/:project/access)

Remove project access for the given team. The __team__ in the request needs to be a string. Can't delete default team's access.

The following arguments are required:

 * __team__: Name of the team

```js
access.remove("consultants", options, callback);
```

### Environments api

Every project has a default environment named Production. Each environment has one configuration document which can have many keys and values.

The following arguments are required:

 * __org__: Name of the organization
 * __project__: Name of the project

```js
var envs = client.envs("bigcompany", "knowledgebase");
```

##### List all environments (GET /orgs/:org/projects/:project/envs)

List all the environmens of the project which can be seen by the authenticated user.

```js
envs.list(options, callback);
```

##### Create an environment (POST /orgs/:org/projects/:project/envs)

Create an environment for the given project. Authenticated user should have access to the project.

The following arguments are required:

 * __name__: Name of the environment
 * __description__: Description of the environment

```js
envs.create("QA", "Quality assurance guys server", options, callback);
```

##### Retrieve an environment (GET /orgs/:org/projects/:project/envs/:env)

Get an environment of the project the user has access to.

The following arguments are required:

 * __env__: Name of the environment

```js
envs.retrieve("qa", options, callback);
```

##### Update an environment (PATCH /orgs/:org/projects/:project/envs/:env)

Update an environment. Authenticated user should have access to the project.

The following arguments are required:

 * __env__: Name of the environment
 * __description__: Description of the environment

```js
envs.update("qa", "Testing server for QA guys", options, callback);
```

##### Delete an environment (DELETE /orgs/:org/projects/:project/envs/:env)

Delete the given environment of the project. Authenticated user should have access to the project. Cannot delete the default environment.

The following arguments are required:

 * __env__: Name of the environment

```js
envs.destroy("knowledgebase", options, callback);
```

### configuration api

Any member of the team which has access to the project can retrieve any of it's environment's configuration document or edit it.

The following arguments are required:

 * __org__: Name of the organization
 * __project__: Name of the project
 * __env__: Name of the environment

```js
var config = client.config("bigcompany", "knowledgebase", "production");
```

##### Retrieve an config (GET /orgs/:org/projects/:project/envs/:env/config)

Get an environment config of the project.

```js
config.retrieve(options, callback);
```

##### Update the configuration (POST /orgs/:org/projects/:project/envs/:env/config)

Update the configuration document for the given environment of the project. We will patch the document recursively.

The following arguments are required:

 * __config__: Configuration to update

```js
config.update({
  database: {
    port: 6984
  },
  random: "wow"
}, options, callback);
```

## Contributors
Here is a list of [Contributors](https://github.com/asm-products/confy-node/contributors)

### TODO

## License
BSD

## Bug Reports
Report [here](https://github.com/asm-products/confy-node/issues).

## Contact
Pavan Kumar Sunkara (pavan.sss1991@gmail.com)
